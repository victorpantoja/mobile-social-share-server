Periódicos
==========

.. include:: ../times/portalpadroes.rst

Existe a necessidade em algumas aplicações de execução periódica de ações.

Visando essa necessidade a aplicação de Periódicos possui sinais Django para
ações periódicas.

Instalação
----------

Para utilizar esta funcionalidade do libby, inclua a seguinte app como INSTALLED_APPS:

.. code-block:: python

    INSTALLED_APPS = [
        #...
        'libby.aplicacoes.periodicos',
        #...
    ]

Utilização
----------

Para utilizar os periódicos, tudo que é necessário é criar na sua app os
listeners dos signals correspondentes, conforme abaixo::

    from libby.aplicacoes.periodicos.signals import periodico_signal

    def handle_periodico_5(sender, request, **kwargs):
        #faz alguma coisa
    
    periodico_signal.connect(handle_periodico_5, sender=5)

    # o sender do signal é o número de minutos do período do mesmo

.. warning::

    É necessária a inclusão no cron do server do projeto que utiliza esta app
    de um HTTP GET (wget, curl, etc) das seguintes urls:

    /libby/aplicacoes/periodicos/periodico/1.html

    /libby/aplicacoes/periodicos/periodico/3.html

    /libby/aplicacoes/periodicos/periodico/5.html

    /libby/aplicacoes/periodicos/periodico/10.html

    /libby/aplicacoes/periodicos/periodico/20.html
