Box vídeo
==========

.. include:: ../times/portalpadroes.rst

.. admonition:: grid

    O box video ocupa 4 colunas do grid, devendo assim estar incluído em uma área que possua 300px.

Dependências
------------

É necessária a inclusão de algumas bibliotecas/componentes para sua utilização correta:

* CDA
    * API de vídeos

Instalação
----------

Para utilizar esta funcionalidade do libby, inclua a seguinte app como INSTALLED_APPS:

.. code-block:: python

    INSTALLED_APPS = [
        #...
        'libby.componentes.box_video',
        #...
    ]

.. admonition:: migration

    Não se esqueça de rodar as migrations após instalar a app. Estas migrations criam o box template e os highlight templates no banco.

Associação
----------

O box de vídeo, como todo box, precisa ser associado a uma área qualquer do template da página em que se deseja usá-lo.

Essa associação pode ser feita manualmente (via migrations ou banco de dados),
ou usando o `admin de associação de área a box provido pelo libby <../aplicacoes/associacao_box.html>`_.

Utilização
----------

Para o funcionamento correto do box de vídeo *EM AMBIENTES QUE NÃO SÃO
PRODUÇÃO*
(dev, qa1, etc), é necessária a inclusão do
seguinte script no grid de CDA:

.. code-block:: html

    <script type="text/javascript" charset="utf-8">
        $('div.container-video').boxVideo({
            environment: 'qa1'
        });
    </script>

.. warning::

    As settings de environment e hostNovoPlayer devem ser passadas corretamente
    para cada ambiente.

    É recomendado o uso do settings da aplicação para guardar estes valores,
    não sendo necessário, no entanto.

Para produção, basta incluir o seguinte script:

.. code-block:: html

    <script type="text/javascript" charset="utf-8">
        $('.container-video').boxVideo();
    </script>

.. warning::
    Vale lembrar que este script *PRECISA* ser incluído após as chamadas do libby
    (ficam após a área js_bottom do globocore).

.. warning::

    É necessária a remoção do script atual que vem no template do globocore.
    A forma indicada de remoção é sobrescrever o bloco js_bottom com o conteúdo
    abaixo.

.. code-block:: html

    {% block js_bottom %}
        {{ block.super }}
        <script type="text/javascript"
                src="{% setting DYNAMO_CACHED_URL %}/scripts/js/glb.recaptcha.js">
        </script>
        {% setting VIDEOS as videos %}
        <script src="http://s.videos.globo.com/p2/j/api.min.js" type="text/javascript"></script>
    {% endblock js_bottom %}

Dado que o box de vídeo está associado a alguma área, para utilizá-lo, basta adicioná-lo a área em questão.

O box de vídeo será apresentado no CMA conforme abaixo:

.. image:: img/box_video/cma.1.jpg

A versão de CDA é apresentada conforme abaixo:

.. image:: img/box_video/cda.1.jpg

O funcionamento dele é similar ao box de vídeo que existe atualmente.
