
<!DOCTYPE HTML>

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE" />
    <meta http-equiv="PRAGMA" content="NO-CACHE" />
    <meta http-equiv="EXPIRES" content="Mon, 22 Jul 2002 11:12:01 GMT" />
    
    <title>Publicação Multi-Dispositivos &mdash; mobile social share v1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/redmond/jquery-ui-1.8.13.custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.8.13.custom.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.8.13.custom.min.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.8.13.custom.min.js"></script>
    <link rel="top" title="mobile social share v1.0.0 documentation" href="../index.html" /> 
  </head>
  <body>

    <div class="container_12">
        <div class="grid_3 logo menu">
            <a href="../index.html" class="logo"><img src="../_static/mss.png"></a>
            <ul class="version">
                <li>v1.0.0 (02-06-2011)</li>
            </ul>

            <div class="menu-accordion">
                <h3><a href="#">Instalação &amp; Uso</a></h3>
                <div>
                    <ul>
                        <li>
                            <a href="../install.html">Instalação</a>
                        </li>
                        <li>
                            <a href="../convencoes.html">Convenções</a>
                        </li>
                        <li>
                            <a href="../tests.html">Plataforma de testes</a>
                        </li>
                        <li>
                            <a href="../contributing.html">Aplicação Demo</a>
                        </li>
                    </ul>
                </div>

                <h3><a href="#">Arquitetura</a></h3>
                <div>
                    <ul class="componentes">
                        <li>
                            <a href="../components/carrossel.html">Carrossel</a>
                        </li>
                    </ul>
                </div>

                <h3><a href="#">Aplicações</a></h3>
                <div>
                    <ul>
                        <li>
                            <a href="associacao_box.html">Associacão box-área</a>
                        </li>
                        <li>
                            <a href="foto.html">Foto</a>
                        </li>
                         <li>
                            <a href="#">Publicação Multi-Dispositivos</a>
                        </li>
                        <li>
                            <a href="analytics_link.html">Analytics Links</a>
                        </li>
                         <li>
                            <a href="periodicos.html">Periódicos</a>
                        </li>
                        <li>
                            <a href="componentes_fixos.html">Componentes Fixos</a>
                        </li>
                    </ul>
                </div>
                
                <h3><a href="#">JS</a></h3>
                <div>
                    <ul>
                        <li>
                            <a href="../js/widget_base.html">Widget Base</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="grid_9 contents">
            
  <div class="section" id="publicacao-multi-dispositivos">
<h1>Publicação Multi-Dispositivos<a class="headerlink" href="#publicacao-multi-dispositivos" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Mantido pela equipe portal padrões</p>
<p class="last"><a class="reference external" href="mailto:timehome&#37;&#52;&#48;corp&#46;globo&#46;com">timehome<span>&#64;</span>corp<span>&#46;</span>globo<span>&#46;</span>com</a></p>
</div>
<p>A aplicação de publicacão multi-dispositivos permite a criação simplificada de
versões de conteúdos da plataforma (home, matéria, galeria) para diferentes
dispositivos (touch-phones, tablets, etc).</p>
<div class="section" id="instalacao">
<h2>Instalação<a class="headerlink" href="#instalacao" title="Permalink to this headline">¶</a></h2>
<p>Para utilizar esta funcionalidade do libby, inclua a seguinte app como INSTALLED_APPS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c">#...</span>
    <span class="s">&#39;libby.aplicacoes.publicacao_multi_dispositivos&#39;</span><span class="p">,</span>
    <span class="c">#...</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Para o funcionamento correto da aplicação de publicação multi-dispositivos,
é necessária a instalação das urls de devices. A <a class="reference external" href="../install.html">página de instalação</a> possui mais detalhes sobre este processo.</p>
</div>
</div>
<div class="section" id="funcionamento">
<h2>Funcionamento<a class="headerlink" href="#funcionamento" title="Permalink to this headline">¶</a></h2>
<p>A aplicação de publicação multi-dispositivos assina os eventos de publicação de
conteúdo do globo.cms (matéria, galeria e home) para publicar, em conjunto, as
versões para cada dispositivo.</p>
<p>Quais dispositivos e quais versões para cada conteúdo fica totalmente a cargo
de cada produto. O libby virá com algumas propostas de versões para
dispositivos móveis (touch-phones).</p>
<p>Para atender a um tipo de dispositivo específico, basta a criação de uma app
que atenda a algumas particularidades.</p>
</div>
<div class="section" id="anatomia-de-app-de-dispositivo">
<h2>Anatomia de App de Dispositivo<a class="headerlink" href="#anatomia-de-app-de-dispositivo" title="Permalink to this headline">¶</a></h2>
<p>Para atender a um novo tipo de dispositivo, muito poucas modificações são
necessárias a uma app django normal.</p>
<p>A primeira é que seja criado um arquivo conf.py como <a class="reference external" href="http://ngit.globoi.com/libby/libby/blobs/master/libby/dispositivos/touchphone/conf.py">este</a>.</p>
<p>A segunda particularidade é a criação de um arquivo chamado device_urls,
contendo as urls que serão publicadas para o dispositivo,
como <a class="reference external" href="http://ngit.globoi.com/libby/libby/blobs/master/libby/dispositivos/touchphone/device_urls.py">este</a>.</p>
</div>
<div class="section" id="conf-py">
<h2>conf.py<a class="headerlink" href="#conf-py" title="Permalink to this headline">¶</a></h2>
<p>Este arquivo de configuração possui duas informações úteis para a publicação de
multi-dispositivos: SLUG_DISPOSITIVO e URLS_PUBLICACAO_MULTI_DISPOSITIVOS.</p>
<p>O primeiro argumento é o SLUG do dispositivo, que será usado para gerar a URL
pela qual o dispositivo será gerado. No caso do arquivo da app touchphone do
libby, a página <em>/index.html</em> seria
gerada em <em>/dispositivos/touchphone/index.html</em>. Já a página
<em>folder1/page.html</em> seria gerada em <em>/dispositivos/touchphone/folder1/page.html</em>.</p>
<p>O segundo argumento são as urls que precisam ser publicadas para este tipo de
dispositivo. No caso do arquivo de urls da app touchphone do libby, estamos especificando que quando uma home for publicada, deve ser utilizada a url de nome &#8216;libby_touchphone_home&#8217;. Mais sobre urls abaixo.</p>
</div>
<div class="section" id="device-urls-py">
<h2>device_urls.py<a class="headerlink" href="#device-urls-py" title="Permalink to this headline">¶</a></h2>
<p>Este arquivo é um arquivo de urls padrão do django. A única coisa importante
a lembrar deste arquivo é que as URLs especificadas aqui <strong>PRECISAM</strong> ter um
nome definido.</p>
<p>Além disso, elas <strong>PRECISAM</strong> aceitar um argumento kwargs chamado &#8216;page_url&#8217;, que
é a url da página original. Este argumento será usado depois para carregar
o model de página (mais abaixo).</p>
<p>Um exemplo destas urls é:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">&#39;(?P&lt;page_url&gt;(.+))$&#39;</span><span class="p">,</span> <span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;libby_touchphone_home&#39;</span><span class="p">),</span>
</pre></div>
</div>
<p>A regra acima pode ser inclusiva pois está abaixo de dispositivos/touchphone.
Sendo assim, não colide com outras regras de outras apps.</p>
</div>
<div class="section" id="app-django-normal">
<h2>App Django Normal<a class="headerlink" href="#app-django-normal" title="Permalink to this headline">¶</a></h2>
<p>Tirando as particularidades acima, a app de um dispositivo em particular nada
mais é que uma app django normal.</p>
<p>Após estas configurações, basta criar views que atendam a cada um dos tipos de
conteúdo e implementar templates/medias/etc.</p>
</div>
<div class="section" id="modelo-de-dados-alternativo">
<h2>Modelo de Dados Alternativo<a class="headerlink" href="#modelo-de-dados-alternativo" title="Permalink to this headline">¶</a></h2>
<p>O modelo de estrutura atual do globocore não é muito otimizado para templates,
dado que os templates acabam fazendo inúmeras queries durante sua renderização.</p>
<p>A app de publicação multi-conteúdos vem com alguns helpers que ajudam a gerar
um modelo mais simples e todo carregado para o template.</p>
<p>Um diagrama ilustrando o modelo de dados simplificado:</p>
<img alt="../_images/model.png" src="../_images/model.png" />
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">LEMBRE: Esta imagem é ilustrativa e pode não estar sincronizada com
a versão mais atual desta aplicação. Para ver os detalhes do modelo
simplificado, o melhor lugar é o <a class="reference external" href="http://ngit.globoi.com/libby/libby/blobs/master/libby/aplicacoes/publicacao_multi_dispositivos/models.py">código do model</a>.</p>
</div>
<p>Para obter o modelo simplificado, basta utilizar o <a class="reference external" href="http://ngit.globoi.com/libby/libby/blobs/master/libby/aplicacoes/publicacao_multi_dispositivos/helpers.py">helper de model</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">libby.aplicacoes.publicacao_multi_dispositivos.helpers</span> <span class="kn">import</span> <span class="n">ModelHelper</span>

<span class="k">def</span> <span class="nf">my_device_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">page_url</span><span class="p">):</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">ModelHelper</span><span class="o">.</span><span class="n">load_by_url</span><span class="p">(</span><span class="n">page_url</span><span class="p">)</span>

    <span class="c">#faz alguma coisa com o model de page</span>
    <span class="c">#renderiza um template ou algo assim</span>
</pre></div>
</div>
</div>
</div>


        </div>
            <div class="clear"></div>
            <div class="grid_12 footer">
                &copy; <a href="../index.html">Copyright</a> Mobile Social Share v1.0.0 - 02-06-2011.
              Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0b2.
            </div>
    </div>
    <script type="text/javascript" charset="utf-8">
        $(function() {
            $('.menu-accordion').accordion({
                autoHeight: false,
                collapsible: true
            });
        });
    </script>
  </body>
</html>